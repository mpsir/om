import{openBlock,createBlock,Fragment,createVNode,renderSlot,createCommentVNode,resolveComponent,mergeProps}from"vue";const _sfc_main$4={name:"toggle-content",props:{show_inner_p:{type:Boolean,default:!0,required:!1}},data:()=>({show_inner:!0}),created(){this.show_inner=this.show_inner_p},mounted(){var e=this,t=this.$refs.controls;if((o=$(t).find(".toggle-handle"))[0]){var o=o[0];$(o).click((function(){e.show_inner=!e.show_inner}))}else console.log("no handle found",'\nadd "toggle-handle" class to any ui element.')}},_hoisted_1$4={ref:"controls"};function _sfc_render$4(e,t,o,r,n,a){return openBlock(),createBlock(Fragment,null,[createVNode("span",_hoisted_1$4,[renderSlot(e.$slots,"control")],512),n.show_inner?renderSlot(e.$slots,"default",{key:0}):createCommentVNode("",!0)],64)}_sfc_main$4.render=_sfc_render$4;const _sfc_main$3={name:"monaco-editor",data:()=>({Value:null,input_type:"string"}),setup:function(e,{attrs:t,slots:o,emit:r,expose:n}){return{editor:{},g:Vue.computed((()=>g))}},props:{modelValue:{type:String,required:!0},update_text:{type:String,required:!1,default:"Update"},lang:{type:String,required:!1,default:"json"},format_on_start:{type:Boolean,required:!1,default:!0},IsReadOnly:{type:Boolean,required:!1,default:!0}},emits:["update:modelValue","update"],created(){this.update_modelValue()},watch:{modelValue:{handler(e,t){this.update_modelValue()},deep:!0}},mounted(){var e=this;this.editor=g.monaco.editor.create(this.$refs.m_editor,{value:e.Value,overviewRulerLanes:0,hideCursorInOverviewRuler:!0,language:e.lang,readOnly:!1,minimap:{enabled:!1},showFoldingControls:"always",scrollbar:{vertical:"hidden",horizontal:"visible"},overviewRulerBorder:!1}),setTimeout((()=>{this.update_editor()}),100),e.format_on_start&&(setTimeout((()=>{this.editor.getAction("editor.action.formatDocument").run()}),500),this.Value=this.editor.getValue()),this.editor.getModel().onDidChangeContent((t=>{e.update_editor(),e.Value=e.editor.getValue(),e.$emit("update:modelValue",e.Value)}));const t=()=>{this.editor.getContribution("editor.contrib.folding").getFoldingModel().then((t=>{t.onDidChange((()=>{e.Value=e.editor.getValue()}))}))};t(),this.editor.onDidChangeModel(t)},methods:{update_editor:function(){const e=19*this.editor.getModel().getLineCount();$(this.$refs.m_editor).css("height",e+"px"),this.editor.layout(),this.Value=this.editor.getValue()},update_modelValue(){this.Value=this.modelValue;try{this.editor.getModel().setValue(this.modelValue),this.format_on_start&&this.editor.getAction("editor.action.formatDocument").run()}catch(e){}},update_parent(){this.$emit("update",this.Value)}}},_hoisted_1$3={key:0},_hoisted_2$1={style:{border:"1px dashed darkgrey"}},_hoisted_3$1={ref:"m_editor",style:{"min-height":"28px"}};function _sfc_render$3(e,t,o,r,n,a){const p=resolveComponent("q-btn");return openBlock(),createBlock(Fragment,null,[o.IsReadOnly?createCommentVNode("",!0):(openBlock(),createBlock("div",_hoisted_1$3,[createVNode(p,{onClick:t[1]||(t[1]=e=>a.update_parent()),color:"white","text-color":"black",label:o.update_text,"no-caps":""},null,8,["label"])])),createVNode("div",_hoisted_2$1,[createVNode("div",_hoisted_3$1,null,512)])],64)}_sfc_main$3.render=_sfc_render$3;const _sfc_main$2={props:{p_address:{type:String,required:!0},t_address:{type:String,required:!0}},name:"block-element",created(){},computed:{g:()=>g}},_hoisted_1$2={key:0,style:{position:"absolute",top:"0px",left:"0px"}};function _sfc_render$2(e,t,o,r,n,a){return openBlock(),createBlock("div",mergeProps(e.$attrs,{style:{border:"1px solid black",padding:"16px",position:"relative"}}),[a.g.r.BlockEditor?(openBlock(),createBlock("div",_hoisted_1$2,[createVNode("button",{onClick:t[1]||(t[1]=e=>a.g.f.Open_Editor(o.p_address,o.t_address))},"?")])):createCommentVNode("",!0),renderSlot(e.$slots,"default")],16)}_sfc_main$2.render=_sfc_render$2;const _sfc_main$1={name:"App",props:{},created(){},computed:{g:()=>g}},_hoisted_1$1={class:"w-screen h-screen line-height-3 absolute z-0"};function _sfc_render$1(e,t,o,r,n,a){return openBlock(),createBlock("div",_hoisted_1$1,[createVNode("div",null,[renderSlot(e.$slots,"default")])])}_sfc_main$1.render=_sfc_render$1,console.log("App",_sfc_main$1),g.h.comps=[_sfc_main$1,_sfc_main$3,_sfc_main$4,_sfc_main$2],g.h.pages=[{name:"home",template:{type:"comp",name:"block-element",children:[]},VApp:{data:"function (){ return {} }",setup:"function (props, { attrs, slots, emit, expose }) { return { } }",computed:"{ g(){ return g } }",components:"{}"}},{name:"home_electron",template:{type:"comp",name:"block-element"},VApp:{data:"function (){ return {} }",setup:"function (props, { attrs, slots, emit, expose }) { return { } }",computed:"{ g(){ return g } }",components:"{}"}}];const _sfc_main={name:"editor",props:{},mounted(){this.try_me()},methods:{try_me(){var e=this.$refs.d1;$(e).draggable(),$(e).resizable()}},name:"editor",created(){},computed:{g:()=>g}},_hoisted_1={ref:"d1",style:{border:"1px solid black"}},_hoisted_2=createVNode("div",null,"1",-1),_hoisted_3=createVNode("div",null,"1",-1),_hoisted_4=createVNode("div",null,"1",-1),_hoisted_5=createVNode("div",null,"1",-1);function _sfc_render(e,t,o,r,n,a){return openBlock(),createBlock("div",_hoisted_1,[createVNode("div",null,[createVNode("button",{onClick:t[1]||(t[1]=e=>a.g.r.Editor=!a.g.r.Editor)},"X")]),_hoisted_2,_hoisted_3,_hoisted_4,_hoisted_5],512)}_sfc_main.render=_sfc_render,g.Editor=_sfc_main,g.r=Vue.reactive({IsLive:!0,BlockEditor:!0,Editor:!0}),g.f={pstring:e=>JSON.parse(JSON.stringify(e)),string:e=>JSON.stringify(e),parse:e=>JSON.parse(e),Socket:{add_socket(){g.f.is_local_host()?io("http://localhost:8080/"):"mpsir.github.io"!=location.host&&g.io("http://super1mpsir-57484.portmap.host:57484/")}},Data:{get_live_data:e=>VueUse.useObservable(Dexie.liveQuery(e)),is_local_host:function(){return"8080"==location.port||"3000"==location.port},get_page_name(){var e=location.search;if(""==e)return"home";const t=new URLSearchParams(e).get("page");return t||"home"}},get_page_array_no:function(e){var t=0;return g.h.pages.forEach((function(o,r){e==o.name&&(t=r)})),t},Resolve:{App(page_object,page_name){var page_address=`g.h.pages[${g.f.get_page_array_no(page_name)}]`,page_object=g.f.pstring(page_object),r={};for(var key in page_object.VApp){var k=page_object.VApp[key],n=`r.${key}`,c=`${n} = ${k}`;eval(c)}return r.template=g.f.Resolve.Template(page_object.template,page_address,page_address+".template"),console.log("r.template\n",r.template),console.log("page_object:in",page_object),console.log("app_object:out",r,"\n\n"),r},Template(e,t,o){var r="";return r+="<App>","string"==typeof e?r+=e:(r+="<block-element",r+=" :p_address=\"'p_address'\"",r+=" :t_address=\"'t_address'\"",r+=">",r+="</block-element>"),r+="</App>"},GetPageFromDB(e){var t=g.h.pages.find((function(t){return e==t.name}));return t||{template:"page not found"}},GetCompFromDB(e){var t=g.h.comps.find((function(t){return e==t.name}));return t||{template:`comp not found : ${e}`}}},App:{async Start(){console.log("\nApp is Starting ...\n\n"),await g.f.App.Create_Editor_App()},async Create_Default_App(){globalThis.hasOwnProperty("process")?g.d.IsElectronApp=!0:g.d.IsElectronApp=!1,g.r.current_page_name=g.f.Data.get_page_name(),g.d.current_page_object=g.f.Resolve.GetPageFromDB(g.r.current_page_name);var e=g.f.Resolve.App(g.d.current_page_object,g.r.current_page_name);g.App_Wrapper=Vue.createApp(e),g.App_Wrapper.component("draggable",vuedraggable),g.App_Wrapper.component("App",g.f.Resolve.GetCompFromDB("App")),g.App_Wrapper.component("monaco-editor",g.f.Resolve.GetCompFromDB("monaco-editor")),g.App_Wrapper.component("toggle-content",g.f.Resolve.GetCompFromDB("toggle-content")),g.App_Wrapper.component("block-element",g.f.Resolve.GetCompFromDB("block-element")),g.App=g.App_Wrapper.mount("#app-div")},async Create_Editor_App(){g.Editor_Wrapper=Vue.createApp(g.Editor),g.Editor_Wrapper.component("draggable",vuedraggable),g.Editor_Wrapper.component("App",g.f.Resolve.GetCompFromDB("App")),g.Editor_Wrapper.component("monaco-editor",g.f.Resolve.GetCompFromDB("monaco-editor")),g.Editor_Wrapper.component("toggle-content",g.f.Resolve.GetCompFromDB("toggle-content")),g.Editor_Wrapper.component("block-element",g.f.Resolve.GetCompFromDB("block-element")),g.Editor=g.Editor_Wrapper.mount("#editor-div")},update(){g.App&&(g.App_Wrapper.unmount(),$("#app-div").removeAttr("data-v-app"),g.f.App.Create_Default_App())}},Open_Editor(e,t){}};
